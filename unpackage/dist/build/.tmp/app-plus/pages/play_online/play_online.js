(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/play_online/play_online"],{"0924":function(e,a,t){"use strict";(function(e,n){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=r(t("a34a")),l=t("2f62"),i=r(t("b39a"));t("2144");function r(e){return e&&e.__esModule?e:{default:e}}function u(e,a,t,n,o,l,i){try{var r=e[l](i),u=r.value}catch(s){return void t(s)}r.done?a(u):Promise.resolve(u).then(n,o)}function s(e){return function(){var a=this,t=arguments;return new Promise(function(n,o){var l=e.apply(a,t);function i(e){u(l,n,o,i,r,"next",e)}function r(e){u(l,n,o,i,r,"throw",e)}i(void 0)})}}function p(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(a){c(e,a,t[a])})}return e}function c(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var _={data:function(){return{loacal_avatarUrl_loc:"../../static/nobody.png",fiveStone:null,winLoc:{whowin:0,whowin_title:"",start:null,end:null,width:null,angle:null},setTime:null,loc1:null,loc:null,data_flag:null,whichplayer:0,shuijishu:null,agree_next_play:!1,next_tablenbr:null,play_group:[{},{player:1,state:"none",player_nickname:null,player_avatarUrl:null},{player:1,state:"none",player_nickname:null,player_avatarUrl:null}],tips_group:{cantouch_flag:!0,mulu_flag:null,show_tips_flag:!0,show_black_tips_flag:!0,get_tips_flag:!0,steps_limit:60,table_name:"",show_wrong_choice_flag:!1,show_tips_last_flag:!1,show_dftx_flag:!1,double_undo_flag:!1,show_qiuzhu_flag:!1,show_find_duishou_flag:!1,show_menu_flag:!1,has_yaoqing_flag:"false",agreeundo_flag:!1},sever_play_data:null}},computed:p({},(0,l.mapState)(["userInfo"])),onShareAppMessage:function(a){return"button"===a.from&&console.log(e(a.target," at pages\\play_online\\play_online.vue:169")),{title:"朋友，来一局五子棋",path:"/pages/play_online/play_online?mulu_flag=ljms_hyyz&player=2&shuijishu="+this.shuijishu}},onLoad:function(){var a=s(o.default.mark(function a(t){var l;return o.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:l=this,console.log(e("初始化棋盘"," at pages\\play_online\\play_online.vue:184")),l.fiveStone=new i.default(15,.98),l.fiveStone.setWinCallback(l.winCallback),l.loc=null,l.tips_group.mulu_flag=t.mulu_flag,l.tips_group.has_yaoqing_flag=t.has_yaoqing_flag,l.whichplayer=t.player,l.shuijishu=t.shuijishu,console.log(e(l.tips_group.mulu_flag," at pages\\play_online\\play_online.vue:194")),a.t0=t.mulu_flag,a.next="ljms_hyyz"===a.t0?13:"ljms_sjpd"===a.t0?20:27;break;case 13:return l.tips_group.show_dftx_flag=3,l.tips_group.get_tips_flag=!1,l.tips_group.show_tips_flag=!1,l.tips_group.show_find_duishou_flag=!0,l.tips_group.show_menu_flag=!0,n.setNavigationBarTitle({title:"巅峰对决"}),a.abrupt("break",28);case 20:return l.tips_group.show_dftx_flag=3,l.tips_group.get_tips_flag=!1,l.tips_group.show_tips_flag=!1,l.tips_group.show_find_duishou_flag=!0,l.tips_group.show_menu_flag=!0,n.setNavigationBarTitle({title:"随机配对"}),a.abrupt("break",28);case 27:return a.abrupt("break",28);case 28:l.$forceUpdate(),l.play_group[l.whichplayer].state="ready",l.update_play_date(),l.setTime=setInterval(function(){l.play_circle()},2e3);case 32:case"end":return a.stop()}},a,this)}));function t(e){return a.apply(this,arguments)}return t}(),methods:p({},(0,l.mapMutations)(["settipslast","cuttipslast","login","logout","setopenid","settipslast","setphonenum","setdbuserifo"]),{handleTip:function(e){this.fiveStone.canStep()&&(this.fiveStone.getStepPosition(e),this.loc=this.fiveStone.getStepLocation(e))},winCallback:function(e){var a=this;a.winLoc.whowin=3-a.fiveStone.stone,1==a.winLoc.whowin&&(a.winLoc.whowin_title="黑胜"),2==a.winLoc.whowin&&(a.winLoc.whowin_title="白胜"),a.whichplayer==a.winLoc.whowin&&(a.play_group[a.whichplayer].state="win",a.update_play_date()),a.whichplayer!=a.winLoc.whowin&&(a.play_group[a.whichplayer].state="loss",a.update_play_date()),a.$forceUpdate(),a.fiveStone.preventStep(),setTimeout(function(){a.restartnewgame()},3e3)},onChessBoardTouchStart:function(e){handleTip(e)},onChessBoardTouchMove:function(e){handleTip(e)},onChessBoardTouchEnd:function(a){if(this.tips_group.cantouch_flag){var t=this;if(t.handleTip(a),null!=t.loc&&null!=t.loc1&&(console.log(e("loc",t.loc.x,t.loc.y," at pages\\play_online\\play_online.vue:285")),console.log(e("loc1",t.loc1.x,t.loc1.y," at pages\\play_online\\play_online.vue:286")),t.loc1.x==t.loc.x&&t.loc1.y==t.loc.y))return t.fiveStone.step(t.loc.x,t.loc.y),t.update_play_date(),t.loc1.x=100,t.loc1.y=100,t.tips_group.cantouch_flag=!1,void t.$forceUpdate();t.loc1==t.loc&&null!=t.loc1||0!=t.fiveStone.chessBoard[t.loc.x][t.loc.y].stoneType||(t.loc1=JSON.parse(JSON.stringify(t.loc)))}},restart:function(){var e=this;n.showModal({title:"警告",content:"是否确定重新开始，重新开始后本局判输",success:function(a){a.confirm?(e.play_group[e.whichplayer].state="renshu",e.update_play_date(),e.winLoc.whowin=e.fiveStone.stone,e.winLoc.whowin_title="认输",e.winLoc.start=null,e.winLoc.end=null,e.fiveStone.preventStep(),e.$forceUpdate(),setTimeout(function(){e.restartnewgame()},3e3)):a.cancel}})},undo:function(){this.play_group[this.whichplayer].state="huiqi",this.update_play_date(),n.showLoading({mask:!0,title:"等待对方回复"})},tap_jieshao:function(){n.navigateTo({url:"../jieshao/jieshao"})},gotozml:function(){var e=this;n.showModal({title:"警告",content:"是否确定要离开本局游戏，离开后无法继续",success:function(a){a.confirm?(e.play_group[e.whichplayer].state="renshu",clearInterval(e.setTime),e.update_play_date(),n.reLaunch({url:"../index2/index2"})):a.cancel}})},start_play:function(){var e=s(o.default.mark(function e(){var a;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=this,"false"!=this.tips_group.has_yaoqing_flag){e.next=6;break}return n.showToast({title:"等待对手中。。。",icon:"none"}),e.abrupt("return");case 6:a.tips_group.show_menu_flag=!1,a.tips_group.cantouch_flag=!1,a.$forceUpdate();case 9:case"end":return e.stop()}},e,this)}));function a(){return e.apply(this,arguments)}return a}(),play_circle:function(){var a=s(o.default.mark(function a(){var t,l;return o.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return t=this,l={form:"get_wzq_dz_data",shuijishu:t.shuijishu},a.next=4,t.download_from_server(l,"sever_play_data");case 4:1==t.whichplayer&&1==t.agree_next_play&&t.sever_play_data[0]["next_tablenbr"].length>5&&(clearInterval(t.setTime),n.reLaunch({url:"../play_online/play_online?mulu_flag=ljms_hyyz&has_yaoqing_flag=true&player=2&shuijishu="+t.sever_play_data[0]["next_tablenbr"]})),t.play_group[1].player_nickname=t.sever_play_data[0].nickName1,t.play_group[1].player_avatarUrl=t.sever_play_data[0].avatarUrl1,t.play_group[2].player_nickname=t.sever_play_data[0].nickName2,t.play_group[2].player_avatarUrl=t.sever_play_data[0].avatarUrl2,1==t.whichplayer&&(t.play_group[2].state=t.sever_play_data[0].state2),2==t.whichplayer&&(t.play_group[1].state=t.sever_play_data[0].state1),t.$forceUpdate(),console.log(e(t.play_group," at pages\\play_online\\play_online.vue:426")),(t.fiveStone.chessboard_total_line.length<t.sever_play_data[0].chessboard.length||"agreehuiqi"==t.play_group[3-t.whichplayer].state)&&(console.log(e("change_history",t.fiveStone.chessboard_total_line," at pages\\play_online\\play_online.vue:431")),t.fiveStone.changehistory(t.sever_play_data[0].chessboard)),"none"!=t.play_group[3-t.whichplayer].state&&(t.tips_group.has_yaoqing_flag=!0,"renshu"==t.play_group[3-t.whichplayer].state?(t.play_group[t.whichplayer].state,t.update_play_date(),t.winLoc.whowin=t.whichplayer,t.winLoc.whowin_title="对方认输",t.tips_group.cantouch_flag=!1,t.$forceUpdate(),setTimeout(function(){t.restartnewgame()},3e3)):"ok"==t.play_group[3-t.whichplayer].state?(t.play_group[t.whichplayer].state="ok",t.update_play_date(),t.fiveStone.stone==t.whichplayer&&(t.tips_group.cantouch_flag=!0)):"huiqi"==t.play_group[3-t.whichplayer].state&&"agreehuiqi"!=t.play_group[t.whichplayer].state&&"notagreehuiqi"!=t.play_group[t.whichplayer].state?n.showModal({content:"对方请求悔棋是否同意？",success:function(e){e.confirm?(t.fiveStone.undo(),t.fiveStone.stone==t.whichplayer&&t.fiveStone.undo(),t.winLoc.whowin=0,t.winLoc.whowin_title="",t.winLoc.start=null,t.winLoc.end=null,t.$forceUpdate(),t.play_group[t.whichplayer].state="agreehuiqi",t.update_play_date()):e.cancel&&(t.play_group[t.whichplayer].state="notagreehuiqi",t.update_play_date())}}):"notagreehuiqi"==t.play_group[3-t.whichplayer].state&&"ok"!=t.play_group[t.whichplayer].state?(n.hideLoading(),n.showToast({title:"对方不同意"}),t.play_group[t.whichplayer].state="ok",t.update_play_date()):"agreehuiqi"==t.play_group[3-t.whichplayer].state&&"ok"!=t.play_group[t.whichplayer].state?(n.hideLoading(),n.showToast({title:"对方同意"}),t.play_group[t.whichplayer].state="ok",t.update_play_date()):t.fiveStone.stone==t.whichplayer&&(t.tips_group.cantouch_flag=!0));case 15:case"end":return a.stop()}},a,this)}));function t(){return a.apply(this,arguments)}return t}(),update_play_date:function(){var e=s(o.default.mark(function e(){var a,t;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a=this,"",t="new_wzq_dz_play"+this.whichplayer+"_update",a.upload_to_server({form:t,nickName:a.userInfo.nickName,avatarUrl:a.userInfo.avatarUrl,openid:a.userInfo.openid,shuijishu:a.shuijishu,state:a.play_group[a.whichplayer].state,chessboard:a.fiveStone.chessboard_total_line,next_tablenbr:a.next_tablenbr});case 4:case"end":return e.stop()}},e,this)}));function a(){return e.apply(this,arguments)}return a}(),restartnewgame:function(){var e=s(o.default.mark(function e(a){var t;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this,n.showModal({content:"是否再来一局？",success:function(e){if(e.confirm){if(t.agree_next_play=!0,1==t.whichplayer)t.sever_play_data[0]["next_tablenbr"].length>5&&n.reLaunch({url:"../play_online/play_online?mulu_flag=ljms_hyyz&has_yaoqing_flag=true&player=2&shuijishu="+t.sever_play_data[0]["next_tablenbr"]});else if(2==t.whichplayer){var a=Math.floor(9e4*Math.random())+1e5,o=(new Date).valueOf()+String(a);t.next_tablenbr=o,t.update_play_date(),t.upload_to_server({form:"new_wzq_dz_start",userid:t.userInfo.userid,nickName:t.userInfo.nickName,phonenum:t.userInfo.phonenum,avatarUrl:t.userInfo.avatarUrl,openid:t.userInfo.openid,card_id:t.card_id,shuijishu:o}),clearInterval(t.setTime),n.reLaunch({url:"../play_online/play_online?mulu_flag=ljms_hyyz&has_yaoqing_flag=true&player=1&shuijishu="+o})}}else e.cancel&&clearInterval(t.setTime)}});case 2:case"end":return e.stop()}},e,this)}));function a(a){return e.apply(this,arguments)}return a}(),wxGetUserInfo:function(a){var t=this;t.userInfo.hasLogin?t.start_play():(console.log(e(a.detail.userInfo," at pages\\play_online\\play_online.vue:591")),a.detail.userInfo?n.login({provider:"weixin",success:function(n){console.log(e("code:",n.code," at pages\\play_online\\play_online.vue:597")),t.login(a.detail.userInfo,n.code),t.upload_oauthData(a.detail.userInfo,n.code),t.start_play()}}):(console.log(e(333,"执行到这里，说明拒绝了授权"," at pages\\play_online\\play_online.vue:605")),n.showToast({title:"为了您更好的体验,请先同意授权",icon:"none",duration:2e3})))},upload_oauthData:function(a,t){var o=this;n.request({url:"https://kaikaiomg.applinzi.com/uni_app_upload.php",method:"POST",data:{form:"oauthData",userid:a.userid,nickName:a.nickName,avatarUrl:a.avatarUrl,city:a.city,country:a.country,gender:a.gender,language:a.language,province:a.province,code:t},header:{"content-type":"application/x-www-form-urlencoded"},success:function(a){200!==a.statusCode?console.log(e("请求失败:",a," at pages\\play_online\\play_online.vue:641")):(console.log(e("success_uodate_oauthData:",a.data[0]," at pages\\play_online\\play_online.vue:643")),o.setopenid(a.data[0].openid),o.setdbuserifo(a.data[0]))}})}})};a.default=_}).call(this,t("0de9")["default"],t("6e42")["default"])},"15f3":function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement;e._self._c},o=[];t.d(a,"a",function(){return n}),t.d(a,"b",function(){return o})},"5e7d":function(e,a,t){"use strict";(function(e){t("c577"),t("921b");n(t("66fd"));var a=n(t("e2da"));function n(e){return e&&e.__esModule?e:{default:e}}e(a.default)}).call(this,t("6e42")["createPage"])},"7d50":function(e,a,t){"use strict";t.r(a);var n=t("0924"),o=t.n(n);for(var l in n)"default"!==l&&function(e){t.d(a,e,function(){return n[e]})}(l);a["default"]=o.a},"840d":function(e,a,t){},ae5e:function(e,a,t){"use strict";var n=t("840d"),o=t.n(n);o.a},e2da:function(e,a,t){"use strict";t.r(a);var n=t("15f3"),o=t("7d50");for(var l in o)"default"!==l&&function(e){t.d(a,e,function(){return o[e]})}(l);t("ae5e");var i=t("2877"),r=Object(i["a"])(o["default"],n["a"],n["b"],!1,null,null,null);a["default"]=r.exports}},[["5e7d","common/runtime","common/vendor"]]]);